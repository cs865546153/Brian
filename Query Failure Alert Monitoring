Query Failure Alert Monitoring
Mechanisms
Cloudera supports a HTTP based API to provide access to all data available through Cloudera Manager in the form of JSON messages. Using this API, we can capture records of failed queries using CURL from command line and feed this data to ITRS on a regular basis (every 5 minutes). Upon encountering a failed query, ITRS will notify the proper users for response options.
Examples
All queries in last 5 minutes (Chrome Browser): https://dsccproxy02i1p.eur.nsroot.net:7183/api/v14/clusters/cluster/services/impala/impalaQueries?filter=query_state=EXCEPTION
(Username: api_test	Password: api_test)

All failed queries in last 5 minutes (Chrome Browser): https://dsccproxy02i1p.eur.nsroot.net:7183/api/v14/clusters/cluster/services/impala/impalaQueries?filter=query_state=EXCEPTION
(Username: api_test	Password: api_test)

CURL command to get failed queries from last 30 minutes:
curl -k -u api_test:api_test https://dsccproxy02i1p.eur.nsroot.net:7183/api/v14/clusters/cluster/services/impala/impalaQueries?filter=query_state=EXCEPTION&from=$(date +%Y-%m-%dT%H:%M:%S --date '-30 min')
Open Questions
Which users to monitor for query failures? Currently outputs failures for all users (GSM / Clarity / IoD / DoD) of all types (ODBC/JDBC/Hue)
What types of query failures should generate an alert? Currently many failures are the result of syntax errors when typing the queries.
Should query scan limit be increased? Currently only outputs last 25 queries that meet the criteria.
Action Plan
1.	Meet with Shanghai team (Song, Yi, Jinghua) to set up ITRS alerting mechanism
2.	Meet with IoD/DoD to determine scope of the alerting
References
Cloudera Manager API
Cloudera Manager API v14 apidocs
